<script>
document.addEventListener('DOMContentLoaded', () => {
  const container = document.getElementById('{{ .id }}');
  if (!container) return;

  const fullscreenBtn = container.querySelector('.gc-btn-fullscreen');
  const muteBtn = container.querySelector('.gc-btn-mute');
  const muteIcon = muteBtn.querySelector('.gc-icon');

  // Fullscreen
  const enterFullscreen = () => {
    if (container.requestFullscreen) container.requestFullscreen();
    else if (container.webkitRequestFullscreen) container.webkitRequestFullscreen();
    else if (container.msRequestFullscreen) container.msRequestFullscreen();
  };
  const exitFullscreen = () => {
    if (document.exitFullscreen) document.exitFullscreen();
    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
    else if (document.msExitFullscreen) document.msExitFullscreen();
  };

  fullscreenBtn.addEventListener('click', () => {
    document.fullscreenElement ? exitFullscreen() : enterFullscreen();
  });

  document.addEventListener('fullscreenchange', () => {
    const isFull = !!document.fullscreenElement;
    container.classList.toggle('gc-fullscreen', isFull);
    fullscreenBtn.querySelector('span').textContent = isFull ? 'Exit Fullscreen' : 'Fullscreen';
  });

  // Mute toggle
  let isMuted = false;
  muteBtn.addEventListener('click', () => {
    isMuted = !isMuted;
    muteBtn.querySelector('span').textContent = isMuted ? 'Unmute' : 'Mute';
    muteIcon.innerHTML = isMuted
      ? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5L6 9H2v6h4l5 4V5z M15 9l4 4m0-4l-4 4"/>'
      : '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5L6 9H2v6h4l5 4V5z" />';
    const iframe = container.querySelector('iframe');
    if (iframe && iframe.contentWindow && iframe.contentWindow.postMessage) {
      // Optionally send mute/unmute message to iframe game
    }
  });
});
</script>

<style>
/* Aspect Ratios */
.gc-aspect-16-9 { padding-top: 56.25%; }
.gc-aspect-9-16 { padding-top: 177.78%; }
.gc-aspect-4-3  { padding-top: 75%; }
.gc-aspect-3-4  { padding-top: 133.33%; }

/* Container */
.gc-container {
  position: relative;
  width: 100%;
  max-width: 800px;
  margin: 1.5rem auto;
  border-radius: 1rem;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(0,0,0,0.2);
}
.gc-inner-gradient {
  position: absolute; inset: 0;
  background: linear-gradient(180deg, #0f172a 0%, #1e293b 100%);
}
.gc-game-content {
  position: absolute;
  inset: 0;
}

/* Fullscreen */
.gc-fullscreen {
  position: fixed!important;
  inset: 0;
  width: 100vw;
  height: 100vh;
  border-radius: 0;
  z-index: 9999;
}
.gc-fullscreen .gc-toolbar {
  position: fixed;
  bottom: 0; left: 0;
  border-radius: 0;
}

/* Toolbar */
.gc-toolbar {
  position: absolute;
  bottom: 0; left: 0; width: 100%;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  padding: 0.4rem 0.6rem;
  box-sizing: border-box;
}
.gc-toolbar-spacer { flex: 1; }
.gc-btn {
  display: flex; align-items: center;
  gap: 0.3rem;
  background: transparent;
  border: none;
  color: white;
  cursor: pointer;
  padding: 0.3rem 0.6rem;
  border-radius: 0.5rem;
}
.gc-btn:hover { background: rgba(255,255,255,0.15); }
.gc-icon { width: 1rem; height: 1rem; }
</style>
